<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zhikou.code.dao.ShopDao">

    <select id="shopData" resultType="shop">
    select t1.shop_name as shopName,t1.shop_photo as shopPhoto,
    t2.user_id as userId,t2.username as userName,
    t1.province,t1.city,t1.district,t1.address,t1.adcode,t1.classify,t1.lon,t1.lat,
    t1.description,t1.create_time as createTime
    from t_shop t1 left join t_user t2 on t1.user_id=t2.user_id
    <where>
        <if test="inputText != null and inputText != '' ">
            t1.shop_name like CONCAT('%',CONCAT(#{inputText},'%'))
        </if>
        <if test="classify != null and classify != '' ">
            and t1.classify=#{classify}
        </if>
        <if test="minLon != 0 and maxLon !=0 and minLat !=0 and maxLat !=0">
            and (t1.lon between #{minLon} and #{maxLon}) and (t1.lat between #{minLat} and #{maxLat})
        </if>
        <if test="adcode != 0 ">
            and adcode=#{adcode}
        </if>
        <if test="adcode == 0">
            and adcode in (120000,120101,120102,120103,120104,120105,120106,120116,120110,120111,120112,120113,120114,120115,120117,120118,120119)
        </if>
    </where>
    </select>

    <select id="queryByUserId" parameterType="Integer" resultType="HashMap">
        select shop_name as shopName,shop_photo as shopPhoto,province,city,district,address,classify,description,create_time as createTime
    </select>

</mapper>